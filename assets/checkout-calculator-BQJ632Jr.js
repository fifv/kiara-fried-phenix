import{__toESM as e,clsx_default as t,require_jsx_runtime as n,require_react as r,useLocalStorage as i}from"./index-BfF3hZ2k.js";import"./isObject-9FbGQutX.js";import"./eq-CR-dtW8f.js";import{_SetCache_default as a,_Set_default as o,_baseUnary_default as s,_cacheHas_default as c,_getNative_default as l,_setToArray_default as u}from"./_setToArray-DKSkhZXP.js";function d(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var f=d;function p(e){return e}var m=p;function h(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var g=h;function _(){}var v=_;function y(e,t){var n=-1,r=e.length;for(t||=Array(r);++n<r;)t[n]=e[n];return t}var ee=y,te=800,ne=16,re=Date.now;function ie(e){var t=0,n=0;return function(){var r=re(),i=ne-(r-n);if(n=r,i>0){if(++t>=te)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ae=ie;function b(e){return function(){return e}}var x=b,S=function(){try{var e=l(Object,`defineProperty`);return e({},``,{}),e}catch{}}(),C=S,w=C?function(e,t){return C(e,`toString`,{configurable:!0,enumerable:!1,value:x(t),writable:!0})}:m,T=w,E=ae(T),D=E;function O(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}var k=O;function A(e){return e!==e}var j=A;function M(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}var N=M;function P(e,t,n){return t===t?N(e,t,n):k(e,j,n)}var F=P;function I(e,t){var n=e==null?0:e.length;return!!n&&F(e,t,0)>-1}var L=I,R=Math.max;function z(e,t,n){return t=R(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=R(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),g(e,this,s)}}var B=z;function V(e,t){return D(B(e,t,m),e+``)}var H=V;function U(e,t,n){for(var r=-1,i=e==null?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}var oe=U;function W(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return-1}var G=W,K=Array.prototype,q=K.splice;function se(e,t,n,r){var i=r?G:F,a=-1,o=t.length,c=e;for(e===t&&(t=ee(t)),n&&(c=f(e,s(n)));++a<o;)for(var l=0,u=t[a],d=n?n(u):u;(l=i(c,d,l,r))>-1;)c!==e&&q.call(c,l,1),q.call(e,l,1);return e}var ce=se;function le(e,t){return e&&e.length&&t&&t.length?ce(e,t):e}var ue=le,de=H(ue),J=de,fe=1/0,pe=o&&1/u(new o([,-0]))[1]==fe?function(e){return new o(e)}:v,me=pe,he=200;function ge(e,t,n){var r=-1,i=L,o=e.length,s=!0,l=[],d=l;if(n)s=!1,i=oe;else if(o>=he){var f=t?null:me(e);if(f)return u(f);s=!1,i=c,d=new a}else d=t?[]:l;outer:for(;++r<o;){var p=e[r],m=t?t(p):p;if(p=n||p!==0?p:0,s&&m===m){for(var h=d.length;h--;)if(d[h]===m)continue outer;t&&d.push(m),l.push(p)}else i(d,m,n)||(d!==l&&d.push(m),l.push(p))}return l}var _e=ge;function Y(e){return e&&e.length?_e(e):[]}var X=Y;const ve=`useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict`;let Z=(e=21)=>{let t=``,n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=ve[n[e]&63];return t};var ye=e(r()),Q=e(n());const $=()=>({consumerIds:[],id:Z(6),name:``,payerIds:[],amountPerPlayer:0}),be=()=>({name:``,id:Z(6)});function xe(){let[e,n]=(0,ye.useState)(0),[r,a]=i(`checkout-calculator/players`,[]),[o,s]=i(`checkout-calculator/entries`,[,,,].fill(0).map(e=>$()));return(0,Q.jsxs)(`div`,{children:[(0,Q.jsxs)(`div`,{className:t(`flex items-center m-2`),children:[(0,Q.jsx)(`button`,{onClick:()=>{a(e=>[be(),...e])},children:`+ Player`}),r.map((e,n)=>(0,Q.jsxs)(`div`,{className:t(`relative`),children:[(0,Q.jsx)(`input`,{className:t(`w-24 `,`rounded py-1 px-2 mx-1 font-mono`),value:e.name,onChange:t=>{e.name=t.currentTarget.value,a(r.slice())}}),(0,Q.jsx)(`button`,{className:t(`py-0 px-2 mx-2`,`absolute right-0 top-1/2 -translate-y-1/2`),onClick:()=>{r.splice(n,1),a(r.slice())},children:`×`})]}))]}),(0,Q.jsxs)(`div`,{className:t(`w-2/3`),children:[(0,Q.jsx)(`button`,{className:t(`bg-green-600 m-2 w-32`),onClick:()=>{s(e=>[$(),...e])},children:`+ Entry`}),o.map((e,n)=>{let i=e.consumerIds.length;return(0,Q.jsx)(`div`,{className:t(`m-2 rounded bg-slate-500/5 p-2`),children:(0,Q.jsxs)(`div`,{className:t(`flex items-center gap-1`),children:[(0,Q.jsx)(`button`,{className:t(`py-0 px-2 mx-2`),onClick:()=>{o.splice(n,1),s(o.slice())},children:`×`}),`在`,(0,Q.jsx)(`input`,{className:t(`rounded py-1 px-2 mx-1 font-mono min-w-[100px]`),value:e.name,onChange:t=>{e.name=t.currentTarget.value,s(o.slice())}}),`上,`,(0,Q.jsx)(`div`,{className:t(`flex flex-col gap-1 shrink-0`),children:r.map(n=>{let r=e.consumerIds.includes(n.id);return(0,Q.jsx)(`div`,{className:t(`border rounded px-1 select-none cursor-pointer `,!r&&`text-white/30 border-white/10`,r&&`border-white/30 bg-green-600`),onClick:()=>{r?(J(e.consumerIds,n.id),s(o.slice())):(e.consumerIds.push(n.id),e.consumerIds=X(e.consumerIds),s(o.slice()))},children:n.name})})}),(0,Q.jsx)(`div`,{className:`shrink-0`,children:`消費了`}),(0,Q.jsxs)(`div`,{className:t(`flex flex-col mx-2 shrink-0`),children:[(0,Q.jsxs)(`div`,{children:[`每人`,(0,Q.jsx)(`input`,{disabled:i===0,className:t(``,i===0&&`text-white/30 text-xs italic`,`rounded h-6 px-2 mx-1 font-mono w-28`),value:i>0?e.amountPerPlayer.toFixed(1):`請先選擇消費者`,onChange:t=>{e.amountPerPlayer=parseFloat(t.currentTarget.value),isNaN(e.amountPerPlayer)&&(e.amountPerPlayer=0),s(o.slice())}}),`¥`]}),(0,Q.jsxs)(`div`,{children:[`總計`,(0,Q.jsx)(`input`,{disabled:i===0,className:t(i===0&&`text-white/30 text-xs italic`,`rounded h-6 px-2 mx-1 font-mono w-28`),value:i>0?(e.amountPerPlayer*i).toFixed(1):`請先選擇消費者`,onChange:t=>{e.amountPerPlayer=parseFloat(t.currentTarget.value)/i,isNaN(e.amountPerPlayer)&&(e.amountPerPlayer=0),s(o.slice())}}),`¥`]})]}),`由`,(0,Q.jsx)(`div`,{className:t(`flex flex-col gap-1 shrink-0`),children:r.map(n=>{let r=e.payerIds.includes(n.id);return(0,Q.jsx)(`div`,{className:t(`border rounded px-1 select-none cursor-pointer `,!r&&`text-white/30 border-white/10`,r&&`border-white/30 bg-green-600`),onClick:()=>{r?(J(e.payerIds,n.id),s(o.slice())):(e.payerIds.push(n.id),e.payerIds=X(e.payerIds),s(o.slice()))},children:n.name})})}),`墊付`]})})})]}),(0,Q.jsx)(`div`,{className:t(`fixed top-12 right-24`),children:r.map(e=>{let n=0,r=0;for(let t of o)t.consumerIds.includes(e.id)&&(n+=t.amountPerPlayer),t.payerIds.includes(e.id)&&(r+=t.amountPerPlayer*t.consumerIds.length/t.payerIds.length);let i=n-r;return(0,Q.jsxs)(`div`,{className:t(`bg-slate-400/5 rounded px-2 select-none cursor-pointer  m-2 p-2`),onClick:()=>{},children:[(0,Q.jsx)(`div`,{className:t(`font-bold`),children:e.name}),(0,Q.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,Q.jsx)(`div`,{className:`text-xs text-white/50`,children:`消費`}),(0,Q.jsx)(`div`,{className:`font-mono font-bold`,children:n.toFixed(1)})]}),(0,Q.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,Q.jsx)(`div`,{className:`text-xs text-white/50`,children:`實付`}),(0,Q.jsxs)(`div`,{className:`font-mono font-bold`,children:[` `,r.toFixed(1)]})]}),(0,Q.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,Q.jsx)(`div`,{className:`text-xs text-white/50`,children:i>0?`還要再付`:`收款`}),(0,Q.jsx)(`div`,{className:t(`font-mono font-bold`,i>0?`text-red-400`:`text-green-400  `),children:Math.abs(i).toFixed(1)})]})]})})})]})}export{xe as default};