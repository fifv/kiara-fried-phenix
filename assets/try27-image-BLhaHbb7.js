import{__toESM as e,clsx_default as t,require_jsx_runtime as n,require_react as r}from"./index-BfF3hZ2k.js";var i=e(r()),a=e(n());function o(){let[e,n]=(0,i.useState)(0),r=(0,i.useRef)(null),o=(0,i.useRef)(null);(0,i.useEffect)(()=>{function e(e){console.log(`resize:`,e),e.forEach(e=>{e.target instanceof HTMLCanvasElement&&(e.target.width=(e.devicePixelContentBoxSize[0]?.inlineSize??0)/1,e.target.height=(e.devicePixelContentBoxSize[0]?.blockSize??0)/1)})}let t=new ResizeObserver(e);return r.current&&t.observe(r.current),o.current&&t.observe(o.current),()=>{t.disconnect()}},[]);function s(){let e=r.current,t=e?.getContext(`2d`);if(e&&t){let n=500,r=500;console.log(`canvas:`,`width`,e.width,`height`,e.height,`render: `,`width`,n,`height`,r);let i=new Uint8ClampedArray(n*r*4),a=new ImageData(i,n,r),o=Math.random();for(let e=0;e<i.length;e+=4){let t=~~(e/4),r=~~(t/n),a=t%n;i[e+0]=255*Math.abs(3*((a-n*1/3)%n)/n),i[e+1]=255*Math.abs(3*((a-n*2/3)%n)/n),i[e+2]=255*Math.abs(3*(-Math.abs(a-n/2)+n/2)/n),i[e+3]=255}t?.putImageData(a,0,0)}}async function c(){let e=r.current?.getContext(`2d`);if(e){let t=new Uint8ClampedArray(300*300*4),n=new ImageData(t,300,300);for(let e=0;e<t.length;e+=4)t[e+0]=0*Math.random(),t[e+1]=255*Math.random(),t[e+2]=0*Math.random(),t[e+3]=51;let r=await createImageBitmap(n,{resizeQuality:`high`});e?.drawImage(r,0,0)}}return(0,a.jsxs)(`div`,{className:t(`select-none`),children:[(0,a.jsx)(`button`,{onClick:()=>{let e=r.current;e&&e.getContext(`2d`)?.clearRect(0,0,e.width,e.height)},children:`X`}),(0,a.jsx)(`button`,{onClick:()=>{s()},onPointerMove:e=>{e.buttons===1&&s()},children:`putImageData(imageData)`}),(0,a.jsx)(`button`,{onClick:async()=>{c()},onPointerMove:e=>{e.buttons===1&&c()},children:`drawImage(imageBitmap)`}),(0,a.jsxs)(`div`,{className:`flex`,children:[(0,a.jsx)(`canvas`,{style:{width:`40vw`,height:`60vh`},className:t(`border border-green-400`),ref:r}),(0,a.jsx)(`canvas`,{style:{width:`40vw`,height:`60vh`},className:t(`border border-green-400`,`[image-rendering:pixelated]`),ref:o})]}),(0,a.jsx)(`button`,{onClick:async()=>{let e=new Uint8ClampedArray(300*300*4),t=new ImageData(e,300,300);for(let t=0;t<e.length;t+=4)e[t+0]=255*Math.random(),e[t+1]=0,e[t+2]=0,e[t+3]=51;let n=r.current,i=n?.getContext(`2d`);if(n&&i){console.time(`imageBitmap`);for(let e=0;e<1e3;e++){i.clearRect(0,0,n.width,n.height);let e=await createImageBitmap(t);i.drawImage(e,0,0)}console.timeEnd(`imageBitmap`),console.time(`imageData`);for(let e=0;e<1e3;e++)i.clearRect(0,0,n.width,n.height),i.putImageData(t,0,0);console.timeEnd(`imageData`)}let a=o.current,s=a?.getContext(`bitmaprenderer`);if(a&&s){console.time(`ctxBitmap.transferFromImageBitmap`);for(let e=0;e<1e3;e++){let e=await createImageBitmap(t);s.transferFromImageBitmap(e)}console.timeEnd(`ctxBitmap.transferFromImageBitmap`)}},children:`benchmark`}),(0,a.jsx)(`img`,{src:`src/assets/ttt.c.png`,alt:``,width:9999,height:720,className:t()})]})}export{o as default};